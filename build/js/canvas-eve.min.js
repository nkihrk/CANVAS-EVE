!function(e){function t(t){for(var s,o,n=t[0],l=t[1],c=t[2],u=0,p=[];u<n.length;u++)o=n[u],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);for(h&&h(t);p.length;)p.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],s=!0,n=1;n<a.length;n++){var l=a[n];0!==i[l]&&(s=!1)}s&&(r.splice(t--,1),e=o(o.s=a[0]))}return e}var s={},i={0:0},r=[];function o(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=s,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(a,s,function(t){return e[t]}.bind(null,s));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var n=window.webpackJsonp=window.webpackJsonp||[],l=n.push.bind(n);n.push=t,n=n.slice();for(var c=0;c<n.length;c++)t(n[c]);var h=l;r.push([7,1]),a()}([,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var s=a(0),i=a.n(s);function r(){}Object.assign(r.prototype,{event(e,t,a,s){a?i()(e).on(t,a,s):i()(e).on(t,s)},transformValue:function(e){const t=e.split("(")[1].split(")")[0].split(", ");return{scaleX:t[0],rotateP:t[1],rotateM:t[2],scaleY:t[3],transformX:t[4],transformY:t[5]}},getRotationRad:function(e){let t;const a=e.css("-webkit-transform")||e.css("-moz-transform")||e.css("-ms-transform")||e.css("-o-transform")||e.css("transform");if("none"!==a){const e=a.split("(")[1].split(")")[0].split(","),s=e[0],i=e[1];t=Math.round(Math.atan2(i,s)*(180/Math.PI))}else t=0;return t<0?(t+360)/180*Math.PI:t/180*Math.PI},calcRadians:function(e,t){return(Math.atan2(t,e)/Math.PI*180+(Math.atan2(t,e)>0?0:360))/180*Math.PI},debugCircle:function(e,t,a,s){s?i()(`#${s}`).append(`<div id="${e}"></div>`):i()("#canvas-eve").append(`<div id="${e}"></div>`),i()(`#${e}`).css({left:`${a[0]}px`,top:`${a[1]}px`,width:"14px",height:"14px",background:t,"border-radius":"50%",position:"absolute","z-index":999,transform:"translateX(-50%) translateY(-50%)",opacity:.8})},iframePointerNone:function(){i()("iframe").css("pointer-events","none")},iframePointerReset:function(){i()("iframe").css("pointer-events","")}});var o=r;var n=function(e,t){function a(){o.call(this)}const s={...o.prototype};return a.prototype=Object.assign(s,{constructor:a,options:{},load(){this.eventLoad(),this.eventLoadResize()},eventReady(){t((function(){const a=t(e).height();t(this.body).prepend('<div id="loader-bg" style="position: fixed; z-index: 1;"><div id="loading"><div class="spin-wrapper"><div class="spinner"></div></div></div></div>'),t("#loader-bg, #loader").height(a).css("display","block")}))},eventLoad(){this.event(e,"load",!1,(function(){t("#loader-bg").delay(900).fadeOut(800,(function(){t(this).remove()})),t("#loading").delay(600).fadeOut(300,(function(){t(this).remove()}))}))},eventLoadResize(){this.event(e,"load resize",!1,(function(){const a=`${e.innerHeight-60}px`,s=`${e.innerWidth/2}px`;t("#footer").css({top:a,left:s})}))}}),a}(window,i.a);var l=function(e,t){function a(e){const a=e.clientWidth,s=a/2,i=a/2*.15,r=s-i,n=.9*(s-i),l=t(e).offset().left+a/2,c=t(e).offset().top+a/2;o.call(this),this.param={container:e,size:a,centerPos:{x:l,y:c},color:{hue:this.options.hue,rgb:this.options.rgb}},this.colorWheel={radius:s,innerRadius:r,thickness:i},this.colorTriangle={radius:n,circlePos:{x:Math.cos(2*Math.PI/3)*n+a/2,y:Math.sin(2*Math.PI/3)*n+a/2}},this.canvas={newCanvasPos:{x:null,y:null},$newCanvasId:null,$canvasId:null},this.oekakiParam={lastBrushPos:{x:0,y:0},isDrawing:!1,useTilt:!1,EPenButton:{tip:1,barrel:2,middle:4,eraser:32}},this.flgs={newcanvas:{newcanvas_flg:!1,create_canvas_avail_flg:!1},brush:{brush_flg:!1,draw_canvas_avail_flg:!1},oekaki:{move_wheelcircle_flg:!1,move_trianglecircle_flg:!1}},this.drawPointerEvents=["pointerdown","pointerup","pointercancel","pointermove","pointerover","pointerout","pointerenter","pointerleave","gotpointercapture","lostpointercapture"],this.drawEvents=["MSPointerDown","MSPointerUp","MSPointerCancel","MSPointerMove","MSPointerOver","MSPointerOut","MSPointerEnter","MSPointerLeave","MSGotPointerCapture","MSLostPointerCapture","touchstart","touchmove","touchend","touchenter","touchleave","touchcancel","mouseover","mousemove","mouseout","mouseenter","mouseleave","mousedown","mouseup","focus","blur","click","webkitmouseforcewillbegin","webkitmouseforcedown","webkitmouseforceup","webkitmouseforcechanged"]}const s={...o.prototype};return a.prototype=Object.assign(s,{constructor:a,options:{hue:0,rgb:[0,0,0],theta:0,brush_size:4,eraser_size:30,canvas_color:"#f0e0d6"},load(){this.drawWheel(),this.drawTriangle(),this.setFlgs(),this.resetFlgs(),this.handleEvents()},setFlgs(){document.addEventListener("mousedown",e=>{if(e.target){if(e.target.closest("#color-oekaki")){const t=this._isWheelArea(e),a=this._isTriangleArea(e);t&&(this.flgs.oekaki.move_wheelcircle_flg=!0),a&&(this.flgs.oekaki.move_trianglecircle_flg=!0)}e.target.closest("#color-wheel-circle")&&(this.flgs.oekaki.move_wheelcircle_flg=!0),e.target.closest("#color-triangle-circle")&&(this.flgs.oekaki.move_trianglecircle_flg=!0),e.target.closest("#reset-res")&&!0===this.flgs.newcanvas.newcanvas_flg&&(this.flgs.newcanvas.create_canvas_avail_flg=!0,this.canvas.newCanvasPos.x=e.clientX-t("#zoom").offset().left,this.canvas.newCanvasPos.y=e.clientY-t("#zoom").offset().top,this._createCanvasWrapper()),e.target.closest(".oekaki-canvas")&&!0===this.flgs.brush.brush_flg&&(this.flgs.brush.draw_canvas_avail_flg=!0)}})},resetFlgs(){document.addEventListener("mouseup",()=>{!0===this.flgs.oekaki.move_wheelcircle_flg&&(this.flgs.oekaki.move_wheelcircle_flg=!1),!0===this.flgs.oekaki.move_trianglecircle_flg&&(this.flgs.oekaki.move_trianglecircle_flg=!1),!0===this.flgs.newcanvas.create_canvas_avail_flg&&(this.flgs.newcanvas.create_canvas_avail_flg=!1,this._createCanvas())})},handleEvents(){document.addEventListener("mousedown",e=>{e.target&&(e.target.closest("#color-oekaki")&&(this._colorWheelArea(e),this._colorTriangleArea(e)),-1!==["#newcanvas-oekaki","#brush-oekaki","#eraser-oekaki","#spuit-oekaki","#filldrip-oekaki"].indexOf(`#${e.target.getAttribute("id")}`)&&this._toggleTool(t(`#${e.target.getAttribute("id")}`),e))}),document.addEventListener("mousemove",e=>{if(e.target){const a=t(this.param.container).offset().left,s=t(this.param.container).offset().top,i=a+this.param.size/2,r=s+this.param.size/2;this.param.centerPos.x=i,this.param.centerPos.y=r,!0===this.flgs.oekaki.move_wheelcircle_flg&&this._updateWheelCircle(e),!0===this.flgs.oekaki.move_trianglecircle_flg&&this._updateTriangleCircle(e),!0===this.flgs.newcanvas.create_canvas_avail_flg&&this._updateCanvasVal(e)}});const a=this;if(window.PointerEvent)for(let s=0;s<this.drawPointerEvents.length;s++)t(e).on(a.drawPointerEvents[s],".oekaki-canvas",(function(e){if(!0===a.flgs.brush.brush_flg){const s=t(this).find("canvas");a._drawCanvasPointer(s,e)}}));else for(let s=0;s<this.drawEvents.length;s++)t(e).on(a.drawEvents[s],".oekaki-canvas",(function(e){if(!0===a.flgs.brush.brush_flg){const s=t(this).find("canvas");a._drawCanvas(s,e)}}))},drawWheel(){const t=100-this.colorWheel.thickness/this.colorWheel.radius*100,a=e.getElementById("color-wheel");this._createWheelCircle(),this._generateConicGradiant(100,1,a),this._generateOverlay(100,t,a)},_generateOverlay(t,a,s){const i=e.createElementNS("http://www.w3.org/2000/svg","circle");i.setAttribute("cx",t),i.setAttribute("cy",t),i.setAttribute("r",a),i.setAttribute("fill","#262533"),s.appendChild(i)},_generateConicGradiant(t,a,s){for(let i=0;i<360*a;i++){const r=e.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("d",this._describeArc(t,t,t,i/a,(i+2)/a)),r.setAttribute("fill",`hsl(${i/a}, 100%, 50%)`),s.appendChild(r)}},_describeArc(e,t,a,s,i){const r=this._polar2Cartesian(e,t,a,i),o=this._polar2Cartesian(e,t,a,s),n=i-s<=180?"0":"1";return["M",r.x,r.y,"A",a,a,0,n,0,o.x,o.y,"L",e,t,"L",r.x,r.y].join(" ")},_polar2Cartesian(e,t,a,s){const i=(s-90)*Math.PI/180;return{x:e+a*Math.cos(i),y:t+a*Math.sin(i)}},_createWheelCircle(){const t=e.createElement("div"),a=this.colorWheel.innerRadius+this.colorWheel.thickness/2,{theta:s}=this.options,i=a*Math.cos(s+1.5*Math.PI)+this.param.size/2,r=a*Math.sin(s+1.5*Math.PI)+this.param.size/2;t.id="color-wheel-circle",t.style.left=`${i}px`,t.style.top=`${r}px`,this.wheelCircle=t,this.param.container.appendChild(t)},_colorWheelArea(e){this._isWheelArea(e)&&this._updateWheelCircle(e)},_isWheelArea(e){const t=this.colorWheel.innerRadius,a=this.colorWheel.radius,s=this.getDistance(this.param.centerPos.x,this.param.centerPos.y,e.clientX,e.clientY);return s>t&&a>s?(console.log("true"),!0):(console.log("false"),!1)},_updateWheelCircle(e){const t=this.wheelCircle,a=this.colorWheel.innerRadius+this.colorWheel.thickness/2,s=this._calculateTheta(e),i=a*Math.cos(s)+this.param.size/2,r=a*Math.sin(s)+this.param.size/2;t.style.left=`${i}px`,t.style.top=`${r}px`;const o=this._calculateHue(e);this.param.color.hue=o,this._updateTriangle(e)},_calculateTheta(e){return(Math.atan2(e.clientY-this.param.centerPos.y,e.clientX-this.param.centerPos.x)/Math.PI*180+(Math.atan2(e.clientY-this.param.centerPos.y,e.clientX-this.param.centerPos.x)>0?0:360))/180*Math.PI},_calculateHue(e){return Math.atan2(e.clientY-this.param.centerPos.y,e.clientX-this.param.centerPos.x)/Math.PI*180+90+(Math.atan2(e.clientY-this.param.centerPos.y,e.clientX-this.param.centerPos.x)/Math.PI*180+90>0?0:360)},drawTriangle(){this._createTriangle(),this._createTriangleCircle(),this._initTriangle(),this._getTriangleColor()},_initTriangle(){const e=this.triangleCtx,t=Math.cos(2*Math.PI/3)*this.colorTriangle.radius,a=Math.sin(2*Math.PI/3)*this.colorTriangle.radius;e.clearRect(0,0,this.param.size,this.param.size),e.save(),e.translate(this.colorWheel.radius,this.colorWheel.radius),e.beginPath(),e.moveTo(t,a),e.lineTo(this.colorTriangle.radius,0),e.lineTo(t,-a),e.closePath(),e.stroke(),e.clip(),e.fillRect(-this.colorWheel.radius,-this.colorWheel.radius,this.param.size,this.param.size);const s=e.createLinearGradient(this.colorTriangle.radius,0,t,0),i=`hsla(${Math.round(this.param.color.hue)}, 100%, 50%, `;s.addColorStop(0,`${i}1)`),s.addColorStop(1,`${i}0)`),e.fillStyle=s,e.fillRect(-this.colorWheel.radius,-this.colorWheel.radius,this.param.size,this.param.size);const r=e.createLinearGradient(t,-a,(t+this.colorTriangle.radius)/2,a/2);r.addColorStop(0,"rgba(255, 255, 255, 1)"),r.addColorStop(1,"rgba(255, 255, 255, 0)"),e.globalCompositeOperation="lighter",e.fillStyle=r,e.fillRect(-this.colorWheel.radius,-this.colorWheel.radius,this.param.size,this.param.size),e.restore()},_updateTriangle(){this._initTriangle(),this._setRgb("#test-oekaki")},_createTriangle(){const t=e.createElement("canvas");t.id="color-triangle",t.width=this.param.size,t.height=this.param.size;const a=t.getContext("2d");this.triangleCtx=a,this.param.container.appendChild(t)},_createTriangleCircle(){const t=e.createElement("div");t.id="color-triangle-circle",t.style.left=`${this.colorTriangle.circlePos.x}px`,t.style.top=`${this.colorTriangle.circlePos.y}px`,this.triangleCircle=t,this.param.container.appendChild(t)},_colorTriangleArea(e){this._isTriangleArea(e)&&this._updateTriangleCircle(e)},_isTriangleArea(e){const t=e.clientX-this.param.centerPos.x,a=e.clientY-this.param.centerPos.y,s=Math.cos(2*Math.PI/3)*this.colorTriangle.radius,i=this.colorTriangle.radius,r=(-t+i)/Math.sqrt(3);return t>s&&i>t&&(Math.abs(a)>=0&&r>=Math.abs(a))},_updateTriangleCircle(e){const a=e.clientX-this.param.centerPos.x,s=e.clientY-this.param.centerPos.y,i=Math.cos(2*Math.PI/3)*this.colorTriangle.radius,r=this.colorTriangle.radius;let o=(a-r)/Math.sqrt(3),n=(-a+r)/Math.sqrt(3);o=a<=i?-Math.sin(2*Math.PI/3)*this.colorTriangle.radius:o,n=a<=i?Math.sin(2*Math.PI/3)*this.colorTriangle.radius:n;const l=this.triangleCircle,c=t(this.param.container),h=c.offset().left,u=c.offset().top,p=e.clientX-h,d=e.clientY-u;i<a&&a<r?(l.style.left=`${p}px`,l.style.top=s>=n?`${n+this.param.size/2}px`:o>=s?`${o+this.param.size/2}px`:`${d}px`):a<=i?(l.style.left=`${i+this.param.size/2}px`,l.style.top=n<=s?`${n+this.param.size/2}px`:s<=o?`${o+this.param.size/2}px`:`${d}px`):r<=a&&(l.style.left=`${r+this.param.size/2}px`,l.style.top=`${this.param.size/2}px`),this.colorTriangle.circlePos.x=l.style.left.replace("px",""),this.colorTriangle.circlePos.y=l.style.top.replace("px",""),this._setRgb("#test-oekaki")},_setRgb(e){const a=this._getTriangleColor(),s=a[0],i=a[1],r=a[2];this.param.color.rgb=[s,i,r],t(e).css("background-color",`rgb(${s},${i},${r})`)},_getRgba(e,t){const a=this.triangleCtx.getImageData(e,t,1,1);return[a.data[0],a.data[1],a.data[2],a.data[3]]},_getTriangleColor(){const e=this.colorTriangle.circlePos.x-this.param.size/2,t=this.colorTriangle.circlePos.y-this.param.size/2,a=Math.cos(2*Math.PI/3)*this.colorTriangle.radius,s=Math.sin(2*Math.PI/3)*this.colorTriangle.radius,i=-Math.tan(Math.PI/6)*e-t-s+Math.tan(Math.PI/6)*a,r=Math.abs(i)*Math.sin(Math.PI/3),o=3*this.colorTriangle.radius/2,n=this.hsl2rgb(this.param.color.hue/360,1,.5),l=[255,255,255],c=[];let h;for(let t=0;t<3;t++)h=l[t]*(o-r)/o+n[t]*(o-(this.colorTriangle.radius-e))/o,h=Math.abs(Math.round(h)),c.push(h);return c},getDistance(e,t,a,s){let i=a-e,r=s-t;return i*=i,r*=r,Math.sqrt(i+r)},hsl2rgb(e,t,a){let s,i,r;if(0===t)s=1,i=1,r=a;else{const o=function(e,t,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+6*(t-e)*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e},n=a<.5?a*(1+t):a+t-a*t,l=2*a-n;s=o(l,n,e+1/3),i=o(l,n,e),r=o(l,n,e-1/3)}return[Math.min(Math.floor(256*s),255),Math.min(Math.floor(256*i),255),Math.min(Math.floor(256*r),255)]},_toggleTool(e,t){1!==t.button&&(t.stopPropagation(),e.toggleClass("active"),void 0!==this.__$toggleButton&&this.__$toggleButton[0]!==e[0]&&this.__$toggleButton.hasClass("active")&&this.__$toggleButton.removeClass("active"),e.hasClass("active")&&(this.__$toggleButton=e),e.hasClass("active")&&"newcanvas-oekaki"===e.attr("id")?this.flgs.newcanvas.newcanvas_flg=!0:this.flgs.newcanvas.newcanvas_flg=!1,e.hasClass("active")&&"brush-oekaki"===e.attr("id")?this.flgs.brush.brush_flg=!0:this.flgs.brush.brush_flg=!1)},_createCanvasWrapper(){const e=this.canvas.newCanvasPos.x,a=this.canvas.newCanvasPos.y;newFile.id+=1,HIGHEST_Z_INDEX+=1;const s=`<div id ="${newFile.id}" class="file-wrap selected-dot oekaki-canvas" style="transition: ${IS_TRANSITION};">`+'<div class="function-wrapper"><div class="thumbtack-wrapper"></div><div class="resize-wrapper"></div><div class="flip-wrapper"></div><div class="trash-wrapper"></div></div><div class="eve-main is-flipped"></div></div>';t("#add-files").append(s);const i=`#${newFile.id}`,r=t(i);r.css({left:`${e*mouseWheelVal}px`,top:`${a*mouseWheelVal}px`,transform:`translate(${xNewMinus}px, ${yNewMinus}px)`,"z-index":HIGHEST_Z_INDEX}),this.canvas.$newCanvasId=r},_updateCanvasVal(e){const a=this.canvas.$newCanvasId,s=this.canvas.newCanvasPos.x,i=this.canvas.newCanvasPos.y,r=e.clientX-t("#zoom").offset().left,o=e.clientY-t("#zoom").offset().top,n=Math.abs(r-s),l=Math.abs(o-i);a.css({width:`${n*mouseWheelVal}px`,height:`${l*mouseWheelVal}px`})},_createCanvas(){const{$newCanvasId:t}=this.canvas.$newCanvasId,a=e.createElement("canvas"),s=t.width(),i=t.height();a.width=s,a.height=i;const r=a.getContext("2d");r.canvas.style.touchAction="none",r.fillStyle=this.options.canvas_color,r.fillRect(0,0,s,i),t.find(".eve-main").append(a),t.removeClass("selected-dot")},_drawCanvasPointer(t,a){const s=t[0].getContext("2d"),i=t[0].getBoundingClientRect(),r=a.clientX,o=a.clientY,n={x:(r-i.left)*mouseWheelVal,y:(o-i.top)*mouseWheelVal};let l=this.options.brush_size;const c=`rgba(${this.param.color.rgb[0]},${this.param.color.rgb[1]},${this.param.color.rgb[2]},1.0)`,h=this.options.canvas_color;if(a.pointerType){switch(a.pointerType){case"touch":case"pen":s.strokeStyle=c,s.lineWidth=l;break;case"mouse":s.strokeStyle=c,s.lineWidth=l,a.buttons!==this.oekakiParam.EPenButton.barrel&&a.buttons!==this.oekakiParam.EPenButton.middle||(l=0,s.lineWidth=0)}switch(a.buttons===this.oekakiParam.EPenButton.eraser&&(s.strokeStyle=h),a.type){case"pointerdown":this.oekakiParam.isDrawing=!0,this.oekakiParam.lastBrushPos=n;break;case"pointerup":this.oekakiParam.isDrawing=!1;break;case"pointermove":if(!this.oekakiParam.isDrawing)return;if(a.buttons===this.oekakiParam.EPenButton.eraser){const e=this.options.eraser_size;s.fillStyle=h,s.fillRect(n.x,n.y,e,e),s.fill()}else if(l>0){s.beginPath(),s.lineCap="round",s.moveTo(this.oekakiParam.lastBrushPos.x,this.oekakiParam.lastBrushPos.y);const e=this._midPointBetween(this.oekakiParam.lastBrushPos,n);s.quadraticCurveTo(this.oekakiParam.lastBrushPos.x,this.oekakiParam.lastBrushPos.y,e.x,e.y),s.lineTo(n.x,n.y),s.stroke()}this.oekakiParam.lastBrushPos=n;break;case"pointerenter":e.body.style.cursor="crosshair";break;case"pointerleave":e.body.style.cursor="default"}}},_drawCanvas(e,t){const a=e[0].getContext("2d"),s=e.getBoundingClientRect(),i=t.clientX,r=t.clientY,o={x:i-s.left,y:r-s.top};if(void 0===o.x||void 0===o.y)return void console.log("WARNING: undefined position");const n=this.options.brush_size;switch(t.type){case"mousedown":case"MSPointerDown":case"touchStart":this.oekakiParam.isDrawing=!0,this.oekakiParam.lastBrushPos=o;break;case"mouseup":case"MSPointerUp":case"touchEnd":this.oekakiParam.isDrawing=!1;break;case"mousemove":case"MSPointerMove":case"touchmove":if(this.oekakiParam.isDrawing){a.lineWidth=n,a.beginPath(),a.lineCap="round",a.moveTo(this.oekakiParam.lastBrushPos.x,this.oekakiParam.lastBrushPos.y);const{midPoint:e}=this._midPointBetween(this.oekakiParam.lastBrushPos,o);a.quadraticCurveTo(this.oekakiParam.lastBrushPos.x,this.oekakiParam.lastBrushPos.y,e.x,e.y),a.lineTo(o.x,o.y),a.stroke()}this.oekakiParam.lastBrushPos=o}},_midPointBetween:(e,t)=>({x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2})}),a}(document,i.a);a(1),a(2),a(3),a(4),a(5),a(6);const c=new n,h=new l(document.getElementById("color-oekaki"));c.load(),h.load()}]);