!function(e){function t(t){for(var s,l,o=t[0],r=t[1],c=t[2],u=0,g=[];u<o.length;u++)l=o[u],Object.prototype.hasOwnProperty.call(a,l)&&a[l]&&g.push(a[l][0]),a[l]=0;for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);for(h&&h(t);g.length;)g.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],s=!0,o=1;o<i.length;o++){var r=i[o];0!==a[r]&&(s=!1)}s&&(n.splice(t--,1),e=l(l.s=i[0]))}return e}var s={},a={0:0},n=[];function l(t){if(s[t])return s[t].exports;var i=s[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,l),i.l=!0,i.exports}l.m=e,l.c=s,l.d=function(e,t,i){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(l.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)l.d(i,s,function(t){return e[t]}.bind(null,s));return i},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/";var o=window.webpackJsonp=window.webpackJsonp||[],r=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var h=r;n.push([7,1]),i()}([,function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){"use strict";i.r(t);var s=i(0),a=i.n(s),n=function(e,t){function i(){}return i.prototype={constructor:i,options:{},load:function(){this.eventReady(),this.eventLoad(),this.eventLoadResize()},eventReady:function(){t((function(){const i=t(e).height();t("#loader-bg, #loader").height(i).css("display","block")}))},eventLoad:function(){this._event("load",(function(){t("#loader-bg").delay(900).fadeOut(800,(function(){t(this).remove()})),t("#loading").delay(600).fadeOut(300,(function(){t(this).remove()}))}))},eventLoadResize:function(){this._event("load resize",(function(){t("#footer").css({top:window.innerHeight-60+"px",left:window.innerWidth/2+"px"})}))},_event:function(i,s){t(e).on(i,s)}},i}(window,a.a),l=function(e,t){function i(e){var i=e.clientWidth,s=i/2,a=i/2*.15,n=s-a,l=.9*(s-a),o=t(e).offset().left+i/2,r=t(e).offset().top+i/2;this.container=e,this.size=i,this.wheelRadius=s,this.wheelInnerRadius=n,this.wheelThickness=a,this.triangleRadius=l,this.centerX=o,this.centerY=r,this.hue=this.options.hue,this.rgb=this.options.rgb,this.triangleCirclePosX=Math.cos(2*Math.PI/3)*l+i/2,this.triangleCirclePosY=Math.sin(2*Math.PI/3)*l+i/2,this.newCanvasX=null,this.newCanvasY=null,this.$newCanvasId=null,this.$canvasId=null,this.drawPointerEvents=["pointerdown","pointerup","pointercancel","pointermove","pointerover","pointerout","pointerenter","pointerleave","gotpointercapture","lostpointercapture"],this.drawEvents=["MSPointerDown","MSPointerUp","MSPointerCancel","MSPointerMove","MSPointerOver","MSPointerOut","MSPointerEnter","MSPointerLeave","MSGotPointerCapture","MSLostPointerCapture","touchstart","touchmove","touchend","touchenter","touchleave","touchcancel","mouseover","mousemove","mouseout","mouseenter","mouseleave","mousedown","mouseup","focus","blur","click","webkitmouseforcewillbegin","webkitmouseforcedown","webkitmouseforceup","webkitmouseforcechanged"],this.lastBrushPos={x:0,y:0},this.isDrawing=!1,this.useTilt=!1,this.EPenButton={tip:1,barrel:2,middle:4,eraser:32},this.flgs={newcanvas:{newcanvas_flg:!1,create_canvas_avail_flg:!1},brush:{brush_flg:!1,draw_canvas_avail_flg:!1}},this._createWheelCircle(),this._createTriangle(),this._createTriangleCircle()}return i.prototype={constructor:i,options:{hue:0,rgb:[0,0,0],theta:0,brush_size:4,eraser_size:30,canvas_color:"#f0e0d6"},load:function(){this.drawWheel(),this.drawTriangle(),this.setFlgs(),this.resetFlgs(),this.handleEvents(),this._getTriangleColor()},setFlgs:function(){var e=this;t(document).on(EVENTNAME_TOUCHSTART,"#color-oekaki",(function(){e._isWheelArea()&&(glFlgs.oekaki.move_wheelcircle_flg=!0,console.log("glFlgs.oekaki.move_wheelcircle_flg is ",glFlgs.oekaki.move_wheelcircle_flg)),e._isTriangleArea()&&(glFlgs.oekaki.move_trianglecircle_flg=!0,console.log("glFlgs.oekaki.move_trianglecircle_flg is ",glFlgs.oekaki.move_trianglecircle_flg))})),t(document).on(EVENTNAME_TOUCHSTART,"#color-wheel-circle",(function(){glFlgs.oekaki.move_wheelcircle_flg=!0,console.log("glFlgs.oekaki.move_wheelcircle_flg is ",glFlgs.oekaki.move_wheelcircle_flg)})),t(document).on(EVENTNAME_TOUCHSTART,"#color-triangle-circle",(function(){glFlgs.oekaki.move_trianglecircle_flg=!0,console.log("glFlgs.oekaki.move_trianglecircle_flg is ",glFlgs.oekaki.move_trianglecircle_flg)})),t(document).on(EVENTNAME_TOUCHSTART,"#reset-res",(function(){1==e.flgs.newcanvas.newcanvas_flg&&(e.flgs.newcanvas.create_canvas_avail_flg=!0,e.newCanvasX=clientFromZoomX,e.newCanvasY=clientFromZoomY,e._createCanvasWrapper(),console.log("self.flgs.newcanvas.create_canvas_avail_flg is ",e.flgs.newcanvas.create_canvas_avail_flg))})),t(document).on(EVENTNAME_TOUCHSTART,".oekaki-canvas",(function(){1==e.flgs.brush.brush_flg&&(e.flgs.brush.draw_canvas_avail_flg=!0,console.log("self.flgs.brush.draw_canvas_avail_flg is ",e.flgs.brush.draw_canvas_avail_flg))}))},resetFlgs:function(){var e=this;t(document).on(EVENTNAME_TOUCHEND,(function(){1==glFlgs.oekaki.move_wheelcircle_flg&&(glFlgs.oekaki.move_wheelcircle_flg=!1,console.log("glFlgs.oekaki.move_wheelcircle_flg is ",glFlgs.oekaki.move_wheelcircle_flg)),1==glFlgs.oekaki.move_trianglecircle_flg&&(glFlgs.oekaki.move_trianglecircle_flg=!1,console.log("glFlgs.oekaki.move_trianglecircle_flg is ",glFlgs.oekaki.move_trianglecircle_flg)),1==e.flgs.newcanvas.create_canvas_avail_flg&&(e.flgs.newcanvas.create_canvas_avail_flg=!1,e._createCanvas(),console.log("self.flgs.newcanvas.create_canvas_avail_flg is ",e.flgs.newcanvas.create_canvas_avail_flg))}))},handleEvents:function(){var e=this;if(t(document).on(EVENTNAME_TOUCHSTART,"#color-oekaki",(function(){e._colorWheelArea(),e._colorTriangleArea()})),t(document).on(EVENTNAME_TOUCHSTART,"#newcanvas-oekaki, #brush-oekaki, #eraser-oekaki, #spuit-oekaki, #filldrip-oekaki",(function(i){e._toggleTool(t(this),i)})),t(document).on(EVENTNAME_TOUCHMOVE,(function(){var i=t(e.container).offset().left,s=t(e.container).offset().top,a=i+e.size/2,n=s+e.size/2;e.centerX=a,e.centerY=n,1==glFlgs.oekaki.move_wheelcircle_flg&&e._updateWheelCircle(),1==glFlgs.oekaki.move_trianglecircle_flg&&e._updateTriangleCircle(),1==e.flgs.newcanvas.create_canvas_avail_flg&&e._updateCanvasVal()})),window.PointerEvent)for(var i=0;i<e.drawPointerEvents.length;i++)t(document).on(e.drawPointerEvents[i],".oekaki-canvas",(function(i){if(1==e.flgs.brush.brush_flg){const s=t(this).find("canvas");e._drawCanvasPointer(s,i)}}));else for(i=0;i<e.drawEvents.length;i++)t(document).on(e.drawEvents[i],".oekaki-canvas",(function(i){if(1==e.flgs.brush.brush_flg){const s=t(this).find("canvas");e._drawCanvas(s,i)}}))},drawWheel:function(){const e=100-this.wheelThickness/this.wheelRadius*100;var t=document.getElementById("color-wheel");this._generateConicGradiant(100,1,t),this._generateOverlay(100,e,t)},_generateOverlay:function(e,t,i){const s=document.createElementNS("http://www.w3.org/2000/svg","circle");s.setAttribute("cx",e),s.setAttribute("cy",e),s.setAttribute("r",t),s.setAttribute("fill","#262533"),i.appendChild(s)},_generateConicGradiant:function(e,t,i){for(var s=0;s<360*t;s++){const a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",this._describeArc(e,e,e,s/t,(s+2)/t)),a.setAttribute("fill","hsl("+s/t+", 100%, 50%)"),i.appendChild(a)}},_describeArc:function(e,t,i,s,a){const n=this._polar2Cartesian(e,t,i,a),l=this._polar2Cartesian(e,t,i,s),o=a-s<=180?"0":"1";return["M",n.x,n.y,"A",i,i,0,o,0,l.x,l.y,"L",e,t,"L",n.x,n.y].join(" ")},_polar2Cartesian:function(e,t,i,s){const a=(s-90)*Math.PI/180;return{x:e+i*Math.cos(a),y:t+i*Math.sin(a)}},_createWheelCircle:function(){var e=document.createElement("div"),t=this.wheelInnerRadius+this.wheelThickness/2,i=this.options.theta,s=t*Math.cos(i+1.5*Math.PI)+this.size/2,a=t*Math.sin(i+1.5*Math.PI)+this.size/2;e.id="color-wheel-circle",e.style.left=s+"px",e.style.top=a+"px",this.wheelCircle=e,this.container.appendChild(e)},_colorWheelArea:function(){this._isWheelArea()&&this._updateWheelCircle()},_isWheelArea:function(){var e=this.centerX,t=this.centerY,i=this.wheelInnerRadius,s=this.wheelRadius,a=this.getDistance(e,t,clientX,clientY);return a>i&&s>a},_updateWheelCircle:function(){var e=this.wheelCircle,t=this.wheelInnerRadius+this.wheelThickness/2,i=this._calculateTheta(),s=t*Math.cos(i)+this.size/2,a=t*Math.sin(i)+this.size/2;e.style.left=s+"px",e.style.top=a+"px";var n=this._calculateHue();this.hue=n,this._updateTriangle()},_calculateTheta:function(){var e=this.centerX,t=this.centerY;return(Math.atan2(clientY-t,clientX-e)/Math.PI*180+(Math.atan2(clientY-t,clientX-e)>0?0:360))/180*Math.PI},_calculateHue:function(){var e=this.centerX,t=this.centerY;return Math.atan2(clientY-t,clientX-e)/Math.PI*180+90+(Math.atan2(clientY-t,clientX-e)/Math.PI*180+90>0?0:360)},drawTriangle:function(){var e=this.triangleCtx,t=Math.cos(2*Math.PI/3)*this.triangleRadius,i=Math.sin(2*Math.PI/3)*this.triangleRadius;e.clearRect(0,0,this.size,this.size),e.save(),e.translate(this.wheelRadius,this.wheelRadius),e.beginPath(),e.moveTo(t,i),e.lineTo(this.triangleRadius,0),e.lineTo(t,-i),e.closePath(),e.stroke(),e.clip(),e.fillRect(-this.wheelRadius,-this.wheelRadius,this.size,this.size);var s=e.createLinearGradient(this.triangleRadius,0,t,0),a="hsla("+Math.round(this.hue)+", 100%, 50%, ";s.addColorStop(0,a+"1)"),s.addColorStop(1,a+"0)"),e.fillStyle=s,e.fillRect(-this.wheelRadius,-this.wheelRadius,this.size,this.size);var n=e.createLinearGradient(t,-i,(t+this.triangleRadius)/2,i/2);n.addColorStop(0,"rgba(255, 255, 255, 1)"),n.addColorStop(1,"rgba(255, 255, 255, 0)"),e.globalCompositeOperation="lighter",e.fillStyle=n,e.fillRect(-this.wheelRadius,-this.wheelRadius,this.size,this.size),e.restore()},_updateTriangle:function(){this.drawTriangle(),this._setRgb("#test-oekaki")},_createTriangle:function(){var e=document.createElement("canvas");e.id="color-triangle",e.width=e.height=this.size;var t=e.getContext("2d");this.triangleCtx=t,this.container.appendChild(e)},_createTriangleCircle:function(){var e=document.createElement("div");e.id="color-triangle-circle",e.style.left=this.triangleCirclePosX+"px",e.style.top=this.triangleCirclePosY+"px",this.triangleCircle=e,this.container.appendChild(e)},_colorTriangleArea:function(){this._isTriangleArea()&&this._updateTriangleCircle()},_isTriangleArea:function(){var e=this.centerX,t=this.centerY,i=clientX-e,s=clientY-t,a=Math.cos(2*Math.PI/3)*this.triangleRadius,n=this.triangleRadius,l=(-i+n)/Math.sqrt(3);return i>a&&n>i&&(Math.abs(s)>=0&&l>=Math.abs(s))},_updateTriangleCircle:function(){var e=this.centerX,i=this.centerY,s=clientX-e,a=clientY-i,n=Math.cos(2*Math.PI/3)*this.triangleRadius,l=this.triangleRadius,o=(s-l)/Math.sqrt(3),r=(-s+l)/Math.sqrt(3);o=s<=n?-Math.sin(2*Math.PI/3)*this.triangleRadius:o,r=s<=n?Math.sin(2*Math.PI/3)*this.triangleRadius:r;var c=this.triangleCircle,h=t(this.container),u=h.offset().left,g=h.offset().top,f=clientX-u,d=clientY-g;n<s&&s<l?(c.style.left=f+"px",c.style.top=a>=r?r+this.size/2+"px":o>=a?o+this.size/2+"px":d+"px"):s<=n?(c.style.left=n+this.size/2+"px",c.style.top=r<=a?r+this.size/2+"px":a<=o?o+this.size/2+"px":d+"px"):l<=s&&(c.style.left=l+this.size/2+"px",c.style.top=this.size/2+"px"),this.triangleCirclePosX=c.style.left.replace("px",""),this.triangleCirclePosY=c.style.top.replace("px",""),this._setRgb("#test-oekaki")},_setRgb:function(e){var t=this._getTriangleColor(),i=t[0],s=t[1],a=t[2];this.rgb=[i,s,a]},_getRgba:function(e,t){var i=this.triangleCtx.getImageData(e,t,1,1);return[i.data[0],i.data[1],i.data[2],i.data[3]]},_getTriangleColor:function(){var e,t=this.triangleCirclePosX-this.size/2,i=this.triangleCirclePosY-this.size/2,s=Math.cos(2*Math.PI/3)*this.triangleRadius,a=Math.sin(2*Math.PI/3)*this.triangleRadius,n=-Math.tan(Math.PI/6)*t-i-a+Math.tan(Math.PI/6)*s,l=Math.abs(n)*Math.sin(Math.PI/3),o=3*this.triangleRadius/2,r=this.hsl2rgb(this.hue/360,1,.5),c=[255,255,255],h=[];for(let i=0;i<3;i++)e=c[i]*(o-l)/o+r[i]*(o-(this.triangleRadius-t))/o,e=Math.abs(Math.round(e)),h.push(e);return h},getDistance:function(e,t,i,s){var a=i-e,n=s-t;return a*=a,n*=n,Math.sqrt(a+n)},hsl2rgb:function(e,t,i){var s,a,n;if(0==t)s=a=n=i;else{var l=function(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e},o=i<.5?i*(1+t):i+t-i*t,r=2*i-o;s=l(r,o,e+1/3),a=l(r,o,e),n=l(r,o,e-1/3)}return[Math.min(Math.floor(256*s),255),Math.min(Math.floor(256*a),255),Math.min(Math.floor(256*n),255)]},rgb2hsl:function(){r/=255,g/=255,b/=255;var e,t,i=Math.max(r,g,b),s=Math.min(r,g,b),a=(i+s)/2;if(i==s)e=t=0;else{var n=i-s;switch(t=a>=.5?n/(2-(i+s)):n/(i+s),i){case r:e=60*((g-b)/n+0);break;case g:e=60*((b-r)/n+2);break;case b:e=60*((r-g)/n+4)}}return[e,t,a]},_toggleTool:function(e,t){1!=t.button&&(t.stopPropagation(),e.toggleClass("active"),null!=this.__$toggleButton&&this.__$toggleButton[0]!=e[0]&&this.__$toggleButton.hasClass("active")&&this.__$toggleButton.removeClass("active"),e.hasClass("active")&&(this.__$toggleButton=e),e.hasClass("active")&&"newcanvas-oekaki"==e.attr("id")?(this.flgs.newcanvas.newcanvas_flg=!0,console.log("this.flgs.newcanvas.newcanvas_flg is ",this.flgs.newcanvas.newcanvas_flg)):(this.flgs.newcanvas.newcanvas_flg=!1,console.log("this.flgs.newcanvas.newcanvas_flg is ",this.flgs.newcanvas.newcanvas_flg)),e.hasClass("active")&&"brush-oekaki"==e.attr("id")?(this.flgs.brush.brush_flg=!0,console.log("this.flgs.brush.brush_flg is ",this.flgs.brush.brush_flg)):(this.flgs.brush.brush_flg=!1,console.log("this.flgs.brush.brush_flg is ",this.flgs.brush.brush_flg)))},_createCanvasWrapper:function(){var e=this.newCanvasX,i=this.newCanvasY;newFile.id+=1,HIGHEST_Z_INDEX+=1;const s='<div id ="'+newFile.id+'" class="file-wrap selected-dot oekaki-canvas" style="transition: '+IS_TRANSITION+';"><div class="function-wrapper"><div class="thumbtack-wrapper"></div><div class="resize-wrapper"></div><div class="flip-wrapper"></div><div class="trash-wrapper"></div></div><div class="eve-main is-flipped"></div></div>';t("#add-files").append(s);const a="#"+newFile.id,n=t(a);n.css({left:e*mouseWheelVal+"px",top:i*mouseWheelVal+"px",transform:"translate("+xNewMinus+"px, "+yNewMinus+"px)","z-index":HIGHEST_Z_INDEX}),this.$newCanvasId=n},_updateCanvasVal:function(){var e=this.$newCanvasId,t=this.newCanvasX,i=this.newCanvasY,s=clientFromZoomX,a=clientFromZoomY,n=Math.abs(s-t),l=Math.abs(a-i);e.css({width:n*mouseWheelVal+"px",height:l*mouseWheelVal+"px"})},_createCanvas:function(){var e=this.$newCanvasId,t=document.createElement("canvas"),i=e.width(),s=e.height();t.width=i,t.height=s;var a=t.getContext("2d");a.canvas.style.touchAction="none",a.fillStyle=this.options.canvas_color,a.fillRect(0,0,i,s),e.find(".eve-main").append(t),e.removeClass("selected-dot")},_drawCanvasPointer:function(e,t){var i=e[0].getContext("2d"),s=e[0].getBoundingClientRect(),a=t.clientX,n=t.clientY,l={x:(a-s.left)*mouseWheelVal,y:(n-s.top)*mouseWheelVal},o=t.pressure;console.log("e.pressure",t.pressure),void 0===o&&(o=this.options.brush_size);var r=t.buttons,c=(t.twist,this.rgb),h="rgba("+c[0]+","+c[1]+","+c[2]+",1)";const u=this.options.canvas_color;if(t.pointerType){switch(t.pointerType){case"touch":case"pen":i.strokeStyle=h,i.lineWidth=o;break;case"mouse":i.strokeStyle=h,i.lineWidth=o,r!=this.EPenButton.barrel&&r!=this.EPenButton.middle||(o=0,i.lineWidth=0)}switch(r==this.EPenButton.eraser&&(i.strokeStyle=u),t.type){case"pointerdown":this.isDrawing=!0,this.lastBrushPos=l;break;case"pointerup":this.isDrawing=!1;break;case"pointermove":if(!this.isDrawing)return;if(r==this.EPenButton.eraser){var g=this.options.eraser_size;i.fillStyle=u,i.fillRect(l.x,l.y,g,g),i.fill()}else if(o>0){i.beginPath(),i.lineCap="round",i.moveTo(this.lastBrushPos.x,this.lastBrushPos.y);var f=this._midPointBetween(this.lastBrushPos,l);i.quadraticCurveTo(this.lastBrushPos.x,this.lastBrushPos.y,f.x,f.y),i.lineTo(l.x,l.y),i.stroke()}this.lastBrushPos=l;break;case"pointerenter":document.body.style.cursor="crosshair";break;case"pointerleave":document.body.style.cursor="default"}}},_drawCanvas:function(e,t){var i=e[0].getContext("2d"),s=e.getBoundingClientRect(),a=t.clientX,n=t.clientY,l={x:a-s.left,y:n-s.top};if(null!=l.x&&null!=l.y){var o=t.pressure;switch(console.log("pressure",o),void 0===o&&(o=this.options.brush_size),t.type){case"mousedown":case"MSPointerDown":case"touchStart":this.isDrawing=!0,this.lastBrushPos=l;break;case"mouseup":case"MSPointerUp":case"touchEnd":this.isDrawing=!1;break;case"mousemove":case"MSPointerMove":case"touchmove":if(this.isDrawing){i.lineWidth=o,i.beginPath(),i.lineCap="round",i.moveTo(this.lastBrushPos.x,this.lastBrushPos.y);var r=this._midPointBetween(this.lastBrushPos,l);i.quadraticCurveTo(this.lastBrushPos.x,this.lastBrushPos.y,r.x,r.y),i.lineTo(l.x,l.y),i.stroke()}this.lastBrushPos=l}}else console.log("WARNING: undefined position")},_midPointBetween:function(e,t){return{x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}}},i}(window,a.a);i(1),i(2),i(3),i(4),i(5),i(6);(new n).load(),new l(document.getElementById("color-oekaki")).load()}]);